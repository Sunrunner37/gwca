#summary Documentation of all GWCA commands
#labels Featured

This page contains documentation of all of the GWCA commands and how they are interacted with.

=How-to use=
First of all, to use GWCA you must inject the .Dll into Guild Wars. This can be done by either renaming the .Dll to 'Graphics.dll' without the quotes and putting it in the Guild Wars folder, or by using a Dll Injector application (search google).

Communication between GWCA and your script is performed using Window Messages, and therefore, your script must have a valid Window hwnd to retrieve information.

In AutoIt3, simply look at some of the scripts in the Source section to get an idea of how it is done. Remember also to 'register' the necessary custom messages for your GUI using 'GUIRegisterMsg(identifier, functionname)'.

You can register up to 3 different messages with GWCA:

  * The WndCallback (0x500): This is used for all general input/output commands, pretty much a requirement to register this message to use GWCA.

  * The SkillLogCallback (0x4A): This uses the WM_COPYDATA message to send a structure from GWCA which contains information about skills being cast.

  * The SkillCancelCallback (0x501): Which is commonly used with the SkillLogCallback if you wish to track which skills are cancelled/interrupted aswell.

For instruction on how to use these 'Callbacks' please have a look at some of the example scripts in Source section.

Also note, that when using the GWCA functions in AutoIt3, remember to set the `$cbType` variable to the right type before you use a command. For example, when you use CA_GETCOORDS, remember to set `$cbType` to "float", so that the values are automatically un-packed.
Return values are always in the `$cbVar` array. `$cbVar[0]` = first value, `$cbVar[1]` = last value.


And last, but still very important:
When using commands that require an id (of an agent), specifying -1 will automatically use your current target, and -2 will automatically use your self.


=List of Commands=
The commands follow a distinct identifier pattern because they are a custom enumeration. To use them in AutoIt3, this enumeration has been pre-declared in 'GWCAConstants.au3' so you don't have to remember all the numbers though.

*General commands:*

|| *Command* || *Id* || *Description* ||
|| CA_GetCurrentTarget || 0x401 || No parameters, returns an integer with the id of your current target. ||
|| CA_GetMyId || 0x402 || No parameters, returns an integer with the id of your own agent. ||
|| CA_Casting || 0x403 || No parameters, returns a boolean which tells whether or not you're using a skill. ||
|| CA_SkillRecharge || 0x404 || Parameter = skillslot, returns an integer which is either a timestamp if the skill is recharging, or 0 if it's recharged. ||
|| CA_SkillAdrenaline || 0x405 || Parameter = skillslot, returns an integer telling how many points of adrenaline the specified skill has. ||
|| CA_StoreVar || 0x406 || Obsolete, so don't use it. ||
|| CA_SetLogAndHwnd || 0x407 || Parameter = boolean to enable skill log, parameter 2 = hwnd of your script's window. ||
|| CA_GetAgentAndTargetPtr || 0x408 || No parameters, used for debugging purposes. ||
|| CA_GetSkillbarSkillId || 0x409 || Parameter = skillslot, obsolete. ||
|| CA_GetMyMaxHP || 0x40A || No parameters, returns an integer with your max hp and an integer with your current hp. ||
|| CA_GetMyMaxEnergy || 0x40B || No parameters, returns an integer with your max energy and an integer with your current energy. ||
|| CA_GetBuildNumber || 0x40C || No parameters, returns an integer with the current build number of the GW client you're running. ||
|| CA_ChangeMaxZoom || 0x40D || Parameter = integer with zoom value, changes your max zoom. Default is 750, default for observer mode is 1400. ||
|| CA_GetLastDialogId || 0x40E || No parameters. Returns an integer with the id of the latest dialog option pressed. To be used with CA_Dialog. ||
|| CA_SetEngineHook || 0x40F || Parameter = boolean whether to turn on or off. Disables rendering of graphics completely lowering CPU usage to 0-1%. Big thanks to ACB for this! ||

----

*Action-related commands:*

|| *Command* || *Id* || *Description* ||
|| CA_Attack || 0x410 || Parameter = id of target, attacks the specified target with weapon. ||
|| CA_Move || 0x411 || Parameters = X and Y coords of location to move to, remember to pack the float values (or simply use MoveEx()) when using this command. ||
|| CA_UseSkill || 0x412 || Parameter = skill slot, parameter 2 = target id. Works on all skills including attack skills. Remember that some skills that target yourself may require that specified (if so, use -2 as target id). Current target = -1. ||
|| CA_ChangeWeaponSet || 0x413 || Parameter = weapon slot, changes weapon set. ||
|| CA_ZoneMap || 0x414 || Parameter = zone id, optional parameter 2 = district number, zones to the outpost/city specified and if district number is provided also attempts to enter that district. ||
|| CA_DropGold || 0x415 || Parameter = amount of gold, drops the gold on the ground. ||
|| CA_GoNpc || 0x416 || Parameter = id of NPC, goes to specified NPC. ||
|| CA_GoPlayer || 0x417 || Parameter = id of player, goes to specified player (for use in outposts/cities). ||
|| CA_GoSignpost || 0x418 || Parameter = id of signpost/chest, goes to specified signpost/chest (yellow name). ||
|| CA_UseAttackSkill || 0x419 || Obsolete, please refer to CA_UseSkill. ||
|| CA_EnterChallenge || 0x41A || No parameters, enters the challenge if you're in a Challenge Mission outpost. ||
|| CA_OpenChest || 0x41B || No parameters, opens the nearest chest if you're within 'close range'. ||
|| CA_SetEventSkillMode || 0x41C || Obsolete, don't use it. ||
|| CA_UseSkillbarSkill || 0x41D || Obsolete, please refer to CA_UseSkill. ||
|| CA_PickupItem || 0x41E || Parameter = id of item, picks up the specified item. ||
|| CA_UseSkillbarAttackSkill || 0x41F || Obsolete, please refer to CA_UseSkill. ||
|| CA_Dialog || 0x420 || Parameter = dialog option id, experimental function, requires knowledge about the NPC's dialog options. Can be found by using CA_GetLastDialogId ||
|| CA_ChangeTarget || 0x421 || Parameter = id of target, changes target. ||
|| CA_StatusBot || 0x422 || Kinda obsolete. ||
|| CA_TargetNearestFoe || 0x423 || No parameters, targets the nearest foe. ||
|| CA_TargetNearestAlly || 0x424 || No parameters, targets the nearest ally. ||
|| CA_TargetNearestItem || 0x425 || No parameters, targets the nearest item/signpost/chest. ||
|| CA_StatusDelay || 0x426 || Kinda obsolete aswell. ||
|| CA_TargetCalledTarget || 0x427 || No parameters, targets the currently called target of the party. ||
|| CA_UseHero1Skill || 0x428 || Parameter = skillslot, parameter 2 = id of target. ||
|| CA_UseHero2Skill || 0x429 || Parameter = skillslot, parameter 2 = id of target. ||
|| CA_UseHero3Skill || 0x42A || Parameter = skillslot, parameter 2 = id of target. ||
|| CA_StatusMiss || 0x42B || Kinda obsolete, yay. ||
|| CA_CancelAction || 0x42C || No parameters, cancels your current action. Just like pressing ESC. ||
|| CA_StatusTab || 0x42D || Yay for obsolete. ||
|| CA_GetNamePtr || 0x42E || Parameter = id of target, returns a pointer to a wchar_t[] with the name of the player (can only be used for players), which can be ReadProcessMemory()'ed. ||
|| CA_CommandHero1 || 0x42F || Parameters = X and Y floats packed of course. To unflag, set X and Y to 0 like this: Cmd($CA_CommandHero1, 0, 0)||
|| CA_CommandHero2 || 0x430 || Same as CA_COMMANDHERO1. ||
|| CA_CommandHero3 || 0x431 || Same as CA_COMMANDHERO1. ||
|| CA_CommandAll || 0x432 || Same as CA_COMMANDHERO1. ||
|| CA_ChangeDistrict || 0x433 || Parameter = region (0 = america, 1 = asia, 2 = europe), parameter 2 = language (experiment around with this!). ||
|| CA_Resign || 0x434 || No parameters. ||
|| CA_ReturnToOutpost || 0x435 || No parameters. "Presses" the Return To Outpost button after resigning. ||
|| CA_GoAgent || 0x436 || Parameter = id of agent. Goes to the specified target. Same as follow. Will not open NPC dialog or attack enemy. ||
|| CA_DonateFaction || 0x437 || No parameters. Donates 5000 faction towards your faction. Not recently tested, but it should require open dialog with Faction Npc. ||
|| CA_SetSkillbarSkill || 0x438 || Parameter = skill slot, parameter 2 = skill id. ||
|| CA_ChangeSecondProfession || 0x439 || Parameter = profession number. Follows this enumeration 0-10 = { None,W,R,Mo,N,Me,E,A,Rt,P,D }. ||
|| CA_TargetNextPartyMember || 0x43A || No parameters. Functions like the GW Control: Targetting - Party Member: Next ||
|| CA_TargetNextFoe || 0x43B || No parameters. Functions like the GW Control: Targetting - Next Foe ||

----

*Specific memory commands:*

|| *Command* || *Id* || *Description* ||
|| CA_GetMapLoading || 0x440 || No parameters, returns an integer which is 0, 1 or 2. ||
|| CA_GetMapId || 0x441 || No parameters, returns the id of the current map/zone. ||
|| CA_GetPing || 0x442 || No parameters, returns the current ping displayed on the Performance Monitor in GW. ||
|| CA_GetLoggedIn || 0x443 || No parameters, returns boolean. ||
|| CA_GetDead || 0x444 || No parameters, returns boolean, but kinda obsolete though. ||
|| CA_GetBalthFaction || 0x445 || No parameters, returns integer of current balthazar faction and integer of maximum balthazar faction. ||
|| CA_GetKurzFaction || 0x446 || No parameters, returns integer of current kurzick faction and integer of maximum kurzick faction. ||
|| CA_GetLuxonFaction || 0x447 || No parameters, returns integer of current luxon faction and integer of maximum luxon faction. ||
|| CA_GetTitleTreasure || 0x448 || No parameters, returns integer of current treasure title. ||
|| CA_GetTitleLucky || 0x449 || No parameters, returns integer of current lucky title. ||
|| CA_GetTitlyUnlucky || 0x44A || No parameters, returns integer of current unlucky title. ||
|| CA_GetTitleWisdom || 0x44B || No parameters, returns integer of current wisdom title. ||

----

*Agent info commands:*

|| *Command* || *Id* || *Description* ||
|| CA_GetAgentExist || 0x450 || Parameter = id of agent/target, returns boolean. ||
|| CA_GetProfessions || 0x451 || Parameter = id of agent, returns integer of primary and integer of secondary profession. ||
|| CA_GetPlayerNumber || 0x452 || Parameter = id of agent, returns integer of player number or, if the agent is an NPC/monster, the 'Model number'. ||
|| CA_GetHP || 0x453 || Parameter = id of agent, returns float between 0 and 1 with the health in percent. ||
|| CA_GetRotation || 0x454 || Parameter = id of agent, returns float of rotation in degrees. ||
|| CA_GetSkill || 0x455 || Parameter = id of agent, returns integer of current skill being used by agent. ||
|| CA_GetCoords || 0x456 || Parameter = id of agent, returns float of X and float of Y coordinate, packed of course. ||
|| CA_GetWeaponSpeeds || 0x457 || Parameter = id of agent, returns floats of the weapon speeds (figure them out yourself if you really need them). ||
|| CA_GetSpiritRange || 0x458 || Obsolete and unfunctional. ||
|| CA_GetTeamId || 0x459 || Parameter = id of agent, returns integer of team id. 1 = blue, 2 = red, 3 = yellow and so on. ||
|| CA_GetCombatMode || 0x45A || Obsolete, don't use it. ||
|| CA_GetModelMode || 0x45B || Also obsolete. ||
|| CA_GetHpPips || 0x45C || Parameter = id of agent, returns integer of how many pips the target has. ||
|| CA_GetEffects || 0x45D || Parameter = id of agent, returns bitmap with the information that displays the different effects that you see on the health bar of the target, like enchanted, poisoned, deep wound etc. ||
|| CA_GetHex || 0x45E || Parameter = id of agent, returns integer. If 0, target is not hexed. If 1, target is hexed without degen and if 2, target is hexed with degen. ||
|| CA_GetModelAnimation || 0x45F || Obsolete. ||
|| CA_GetEnergy || 0x460 || Obsolete, as it only works for yourself. Just use CA_GetMyMaxEnergy. ||
|| CA_GetAgentPtr || 0x461 || Parameter = id of agent, returns pointer to the agent structure of target in GW memory. ||
|| CA_GetType || 0x462 || Parameter = id of agent, returns integer. 0xDB = players/npc's/monsters (living stuff), 0x200 = signposts/chests/solid objects, 0x400 = items that can be picked up. ||
|| CA_GetLevel || 0x463 || Parameter = id of agent, returns integer with the level. ||
|| CA_GetNameProperties || 0x464 || Obsolete. ||
|| CA_GetMaxId || 0x465 || No parameters, returns integer with the size of the agent array divided by 4 (because the agent array consists of Agent pointers (pointer = 4 bytes)). ||
|| CA_GetMyNearestAgent || 0x466 || No parameters, returns id of your nearest agent. ||
|| CA_GetMyDistanceToAgent || 0x467 || Parameter = id of agent, returns float with distance. ||
|| CA_GetNearestAgentToAgent || 0x468 || Parameter = id of agent, returns id of the nearest agent to the specified agent. ||
|| CA_GetDistanceFromAgentToAgent || 0x469 || Obsolete, so don't bother using it. ||
|| CA_GetNearestAgentToAgentEx || 0x46A || Parameter = id of agent, same as CA_GetNearestAgentToAgent, but also returns float with distance between them. ||
|| CA_GetModelState || 0x46B || Kinda obsolete. ||
|| CA_GetIsAttacking || 0x46C || Parameter = id of agent, returns boolean. ||
|| CA_GetIsKnockedDown || 0x46D || Parameter = id of agent, returns boolean. ||
|| CA_GetIsMoving || 0x46E || Same as the other 'IS' commands. ||
|| CA_GetIsDead || 0x46F || Same as the other 'IS' commands. ||
|| CA_GetIsCasting || 0x470 || Obsolete when there's CA_GetSkill, but whatever. ||
|| CA_GetFirstAgentByPlayerNumber || 0x471 || Parameter = player/model number, returns the first (id-wise) agent with that number. ||
|| CA_GetAllegiance || 0x472 || Parameter = id of agent, returns integer with the allegiance of agent. 0x100 = ally/non-attackable, 0x300 = enemy, 0x400 = spirit/pet, 0x500 = minion, 0x600 = npc/minipet. ||
|| CA_GetNearestEnemyToAgentEx || 0x473 || Parameter = id of agent, returns id of nearest enemy to agent by team id (so, only for PvP) and float of distance. ||
|| CA_GetIsAttackedMelee || 0x474 || Parameter = id of agent, returns integer with estimate of whether agent is being attacked by melee. Kinda obsolete function. ||
|| CA_GetNearestItemToAgentEx || 0x475 || Parameter = id of agent, returns id of item and distance as float. ||
|| CA_GetNearestAgentByPlayerNumber || 0x476 || Same as CA_GetFirstAgentByPlayerNumberexcept it returns the nearest agent to you. ||
|| CA_GetSpeed || 0x477 || Parameter = id of agent, returns float with current speed of agent (how far the agent moves per second in GW units). ||
|| CA_GetNearestEnemyToAgentByAllegiance || 0x478 || Parameter = id of agent, returns id of enemy and distance as float. Only works for yourself or your allies. ||
|| CA_GetNearestAliveEnemyToAgent || 0x479 || Parameter = id of agent, returns id of enemy and distance as float. Only works for yourself or your allies. ||
|| CA_GetWeaponType || 0x47A || Parameter = id of agent, returns integer with weapon type. 1=bow, 2=axe, 3=hammer, 4=daggers, 5=scythe, 6=spear, 7=sword, 10=wand. ||
|| CA_GetNearestSignpostToAgent || 0x47B || Parameter = id of agent, returns id of the nearest signpost/chest. ||
|| CA_GetNearestNpcToAgentByAllegiance || 0x47C || Parameter = id of agent, returns id of the nearest NPC. ||
|| CA_GetNearestAgentToCoords || 0x47D || Don't use this command, instead, use the wrapper function GetNearestAgentToCoords() declared in 'GWCAConstants.au3'. ||
|| CA_GetVars || 0x47E || Don't use this command. It's used for commands like CA_GETNEARESTAGENTTOCOORDS though. ||
|| CA_GetNearestNpcToCoords || 0x47F || Exactly the same as CA_GETNEARESTAGENTTOCOORDS, so don't use it, use GetNearestNpcToCoords() declared in 'GWCAConstants.au3' instead. ||
|| CA_GetLoginNumber || 0x480 || Parameter = id of agent. Returns the unique login number in instance of player. If used on non-player it will return 0. ||
|| CA_GetNumberOfAgentsByPlayerNumber || 0x481 || Parameter = player/model number. Returns the number of alive agents within compass range with specified id. ||
|| CA_GetNumberOfAliveEnemyAgents || 0x482 || No parameters. Returns the number of alive and visible enemy agents in total. ||
|| CA_GetNextItem || 0x483 || Parameter = starting id. Returns the agent id of the next item. For looping through all items, use this command with the returned agent id as parameter after taking care of that item. ||
|| CA_GetTarget || 0x484 || Parameter = agent id. Returns the currently logged target of the specified agent. ||

----

*Item related commands:*

|| *Command* || *Id* || *Description* ||
|| CA_GetGold || 0x510 || No parameters. Returns integer with gold on your character and integer with gold in your storage. ||
|| CA_GetBagSize || 0x511 || Parameter = bag index (1 = backpack to 5 = equip pack). Returns integer with number of slots in the bag. ||
|| CA_SetBag || 0x512 || Parameter = bag index. Sets the current bag to work with. ||
|| CA_GetItemId || 0x513 || Parameter = item slot. Returns item id and item model id. ||
|| CA_GetIdKit || 0x514 || No parameters. Returns item id of the first ID kit it finds. If return is non-zero then you have an ID kit in your inventory. ||
|| CA_IdentifyItem || 0x515 || Parameter = bag index, parameter 2 = item slot. ||
|| CA_IdentifyItemById || 0x516 || Parameter = item id. If you've returned the item id from one of the prior commands you can use this command instead of CA_IdentifyItem. ||
|| CA_DepositGold || 0x517 || Parameter = amount of gold to deposit in storage. Specify -1 if you want to deposit the maximum amount. Can be used anywhere in the outpost. ||
|| CA_WithdrawGold || 0x518 || Parameter = amount of gold to withdraw from storage. Specify -1 if you want to withdraw the maximum amount. Can be used anywhere in the outpost. ||
|| CA_SellItem || 0x519 || Parameter = bag index, parameter 2 = item slot. Requires an open dialog with the Merchant of the outpost! ||
|| CA_SellItemById || 0x51A || Parameter = item id. Requires an open dialog with the Merchant of the outpost! ||
|| CA_BuyIdKit || 0x51B || No parameters. Requires an open dialog with the Merchant of the outpost! ||
|| CA_BuySuperiorIdKit || 0x51C || No parameters. Requires an open dialog with the Merchant of the outpost! ||
|| CA_PrepareMoveItem || 0x51D || For internal use. Use the wrapper functions MoveItem() and MoveItemById() instead. ||
|| CA_MoveItem || 0x51E || For internal use. Use the wrapper functions MoveItem() and MoveItemById() instead. ||
|| CA_GetItemInfo || 0x51F || Parameter = item slot. Returns integer with item rarity and integer with quantity. ||
|| CA_UseItem || 0x520 || Parameter = bag index, parameter 2 = item slot. Uses the item specified. ||
|| CA_UseItemById || 0x521 || Parameter = item id. Uses the item specified. ||
|| CA_DropItem || 0x522 || Parameter = bag index, parameter 2 = item slot. Drops the specified item. If the quantity is above 1 then this command will drop it all. ||
|| CA_DropItemById || 0x523 || Parameter = item id, parameter 2 = amount. Drops the specified item by the specified amount. Setting amount to -1 will drop it all. ||
|| CA_AcceptAllItems || 0x524 || No parameters. Accepts all unclaimed items (from the unclaimed items window that may appear). Doesn't check if there isn't room for all the items, this simply accepts them! ||
|| CA_GetItemLastModifier || 0x525 || Parameter = item slot. Returns integer with the last modifier of the item and wchar_t`*` with customize text. Last modifier can be used to check which dye (model id 146) it is. If customize text = 0 then item is not customized. ||
|| CA_FindItemByModelId || 0x526 || Parameter = item model id. Searches for the first occurence of the specified model id and returns integer with the item id or 0 if item wasn't found. ||
|| CA_FindEmptySlot || 0x527 || Parameter = bag index to start searching from. Returns integer with bag index and integer with item slot. This function also searches the storage. If any of the returns = 0, then no empty slots were found. ||
|| CA_FindGoldItem || 0x528 || Optional parameter = bag index of last bag to search in. Searches from the backpack until (and including) the bag index supplied. If not set the function will search all bags including storage. The return is integer with item id of the gold item found and integer with the item's model id. If return value is 0 then no gold items were found. ||
|| CA_GetItemPositionByItemId || 0x529 || Parameter = item id. Returns the position of the item; bag and slot-wise. If any of the returns are 0, the item was not found. ||
|| CA_GetItemPositionByModelId || 0x52A || Parameter = item model id. Returns the position of the item; bag and slot-wise. If any of the returns are 0, the item was not found. ||
|| CA_GetItemPositionByRarity || 0x52B || Parameter = rarity (use constants declared in GWCAConstants.au3). Returns the position of the item; bag and slot-wise. If any of the returns are 0, the item was not found. ||
|| CA_GetItemModelIdById || 0x52C || Parameter = item id. Returns the model id of the specified item. ||
|| CA_GetItemInfoById ||0x52D || Parameter = item id. Returns the rarity and quantity of the specified item. ||
|| CA_GetItemLastModifierById || 0x52E || Parameter = item id. Returns the last modifier (see CA_GetItemLastModifier) and customized text of the specified item. ||
|| CA_EquipItem || 0x52F || Parameter = bag index, parameter 2 = item slot. Equips the specified item. ||
|| CA_EquipItemById || 0x530 || Parameter = item id. Equips the specified item. ||

----

*Title related commands:*

|| *Command* || *Id* || *Description* ||
|| CA_GetTitleSunspear || 0x550 || No parameters. Returns integer with title progress. ||
|| CA_GetTitleLightbringer || 0x551 || No parameters. Returns integer with title progress. ||
|| CA_GetTitleVanguard || 0x552 || No parameters. Returns integer with title progress. ||
|| CA_GetTitleNorn || 0x553 || No parameters. Returns integer with title progress. ||
|| CA_GetTitleAsura || 0x554 || No parameters. Returns integer with title progress. ||
|| CA_GetTitleDeldrimor || 0x555 || No parameters. Returns integer with title progress. ||
|| CA_GetTitleNorthMastery || 0x556 || No parameters. Returns integer with title progress. ||
|| CA_GetTitleDrunkard || 0x557 || No parameters. Returns integer with title progress. ||
|| CA_GetTitleSweet || 0x558 || No parameters. Returns integer with title progress. ||
|| CA_GetTitleParty || 0x559 || No parameters. Returns integer with title progress. ||
|| CA_GetTitleCommander || 0x55A || No parameters. Returns integer with title progress. ||
|| CA_GetTitleLuxon || 0x55B || No parameters. Returns integer with title progress. ||
|| CA_GetTitleKurzick || 0x55C || No parameters. Returns integer with title progress. ||

----

*More general commands:*

|| *Command* || *Id* || *Description* ||
|| CA_AddHero || 0x580 || Parameter = hero id. Adds hero to the party. ||
|| CA_KickHero || 0x581 || Parameter = hero id. Kicks hero from the party. ||
|| CA_SwitchMode || 0x582 || Parameter = boolean to set HM or NM. HM = 1, NM = 0. ||
|| CA_AddNpc || 0x583 || Parameter = henchman id according to Party Search list. Adds henchman to the party. ||
|| CA_KickNpc || 0x584 || Parameter = henchman id. Kicks henchman from the party. ||
|| CA_TravelGH || 0x585 || No parameters. Travels to your Guild Hall. ||
|| CA_LeaveGH || 0x586 || No parameters. Leaves your Guild Hall. ||
|| CA_InitMapLoad || 0x587 || No parameters. Inits the CA_MapIsLoaded command. ||
|| CA_MapIsLoaded || 0x588 || No parameters. Returns boolean. Use CA_InitMapLoad before !!! ||